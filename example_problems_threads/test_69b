c 
c Simple example to illustrate/test use of the cohesive zone
c material model and the interface elements.
c 
c model is 2 rectangular prisms of size (x,y,z) = (1,1,1) connected
c on the z = 1.0 plane by 8-node interface elements
c
c the interface elements are normal to Z=1.0. The axial (w) displacements
c on nodes 1-6 (Z  =2.0) are used to check the half-symmetry
c model in the follow-on test problem. The w-displacements in the
c half-symmetry model should be 0.5 x these displacements.
c
c elements 1-27 are in cube incident on Z=0 plane
c elements 28-54 are next cube over z=1.0 to z=2.0
c elements 55-63 are the interface elements on Z=1.0 plane
c
c Elements 1-54 are linear elastic solids. nodes 1-16 are one the
c remote end (z = 2.0)
c
c the model is loaded by axial (tensile) traction in the Z-direction.
c X = 0, Y = 0, Z = 0 are symmetry planes
c
c The material property values set here for the exp1_intf and ppr
c optiuons are chosen explicitly to provide near identical traction-
c separation curves for axial (normal traction) loading.
c
c Also for the PPR, be careful in setting the specified 
c values of properties ratio_normal and ratio_shear
c which set the value of peak displacement as a fraction of
c the displacement when traction degrade to zero. Small values
c (e.g. 0.001) lead to excessively high stiffness levels early in the
c loading history - if the surrounding solid elements have markedly
c smaller stiffnesses, solution of the euilibrium equations
c introduces much error and the Newton iterations diverge.
c
c this model can be run with small or large displacements
c
structure full
c
material solid
 properties linear_elastic  e 200 nu 0.3 
c
material ppr_matl  $ matches v. closely exp1_matl
 properties cohesive ppr,
    sig_peak 5.0 tau_peak 5.0 G_normal 1.85,
    G_shear 1.85 shape_normal 7.0 shape_shear 7.0,
    ratio_normal 0.1 ratio_shear 0.1 $ do not make these too small !
c
material exp1_matl
 properties cohesive exp1_intf,
     sig_peak 5.0 delta_peak 0.1359141 beta 1.0 
c
material linear_matl
 properties cohesive linear_intf,
    stiffn 100 stifft 100 stiffs 100
c
number of nodes  128 elements       63
c
coordinates
*echo off
      1  0.000000000E+00  0.100000000E+01  0.200999999E+01
      2  0.333333343E+00  0.100000000E+01  0.200999999E+01
      3  0.666666687E+00  0.100000000E+01  0.200999999E+01
      4  0.100000000E+01  0.100000000E+01  0.200999999E+01
      5  0.000000000E+00  0.666666687E+00  0.200999999E+01
      6  0.000000000E+00  0.333333343E+00  0.200999999E+01
      7  0.000000000E+00  0.000000000E+00  0.200999999E+01
      8  0.333333343E+00  0.666666687E+00  0.200999999E+01
      9  0.666666687E+00  0.666666687E+00  0.200999999E+01
     10  0.100000000E+01  0.666666687E+00  0.200999999E+01
     11  0.333333343E+00  0.333333343E+00  0.200999999E+01
     12  0.333333343E+00  0.000000000E+00  0.200999999E+01
     13  0.666666687E+00  0.333333343E+00  0.200999999E+01
     14  0.100000000E+01  0.333333343E+00  0.200999999E+01
     15  0.666666687E+00  0.000000000E+00  0.200999999E+01
     16  0.100000000E+01  0.000000000E+00  0.200999999E+01
     17  0.000000000E+00  0.100000000E+01  0.167666674E+01
     18  0.333333343E+00  0.100000000E+01  0.167666674E+01
     19  0.666666687E+00  0.100000000E+01  0.167666674E+01
     20  0.100000000E+01  0.100000000E+01  0.167666674E+01
     21  0.000000000E+00  0.666666687E+00  0.167666674E+01
     22  0.000000000E+00  0.333333343E+00  0.167666674E+01
     23  0.000000000E+00  0.000000000E+00  0.167666674E+01
     24  0.333333343E+00  0.666666687E+00  0.167666674E+01
     25  0.666666687E+00  0.666666687E+00  0.167666674E+01
     26  0.100000000E+01  0.666666687E+00  0.167666674E+01
     27  0.333333343E+00  0.333333343E+00  0.167666674E+01
     28  0.333333343E+00  0.000000000E+00  0.167666674E+01
     29  0.666666687E+00  0.333333343E+00  0.167666674E+01
     30  0.100000000E+01  0.333333343E+00  0.167666674E+01
     31  0.666666687E+00  0.000000000E+00  0.167666674E+01
     32  0.100000000E+01  0.000000000E+00  0.167666674E+01
     33  0.000000000E+00  0.100000000E+01  0.134333336E+01
     34  0.333333343E+00  0.100000000E+01  0.134333336E+01
     35  0.666666687E+00  0.100000000E+01  0.134333336E+01
     36  0.100000000E+01  0.100000000E+01  0.134333336E+01
     37  0.000000000E+00  0.666666687E+00  0.134333336E+01
     38  0.000000000E+00  0.333333343E+00  0.134333336E+01
     39  0.000000000E+00  0.000000000E+00  0.134333336E+01
     40  0.333333343E+00  0.666666687E+00  0.134333336E+01
     41  0.666666687E+00  0.666666687E+00  0.134333336E+01
     42  0.100000000E+01  0.666666687E+00  0.134333336E+01
     43  0.333333343E+00  0.333333343E+00  0.134333336E+01
     44  0.333333343E+00  0.000000000E+00  0.134333336E+01
     45  0.666666687E+00  0.333333343E+00  0.134333336E+01
     46  0.100000000E+01  0.333333343E+00  0.134333336E+01
     47  0.666666687E+00  0.000000000E+00  0.134333336E+01
     48  0.100000000E+01  0.000000000E+00  0.134333336E+01
     49  0.000000000E+00  0.100000000E+01  0.100999999E+01
     50  0.333333343E+00  0.100000000E+01  0.100999999E+01
     51  0.666666687E+00  0.100000000E+01  0.100999999E+01
     52  0.100000000E+01  0.100000000E+01  0.100999999E+01
     53  0.000000000E+00  0.666666687E+00  0.100999999E+01
     54  0.000000000E+00  0.333333343E+00  0.100999999E+01
     55  0.000000000E+00  0.000000000E+00  0.100999999E+01
     56  0.333333343E+00  0.666666687E+00  0.100999999E+01
     57  0.666666687E+00  0.666666687E+00  0.100999999E+01
     58  0.100000000E+01  0.666666687E+00  0.100999999E+01
     59  0.333333343E+00  0.333333343E+00  0.100999999E+01
     60  0.333333343E+00  0.000000000E+00  0.100999999E+01
     61  0.666666687E+00  0.333333343E+00  0.100999999E+01
     62  0.100000000E+01  0.333333343E+00  0.100999999E+01
     63  0.666666687E+00  0.000000000E+00  0.100999999E+01
     64  0.100000000E+01  0.000000000E+00  0.100999999E+01
     65  0.000000000E+00  0.100000000E+01  0.100000000E+01
     66  0.333333343E+00  0.100000000E+01  0.100000000E+01
     67  0.666666687E+00  0.100000000E+01  0.100000000E+01
     68  0.100000000E+01  0.100000000E+01  0.100000000E+01
     69  0.000000000E+00  0.666666687E+00  0.100000000E+01
     70  0.000000000E+00  0.333333343E+00  0.100000000E+01
     71  0.000000000E+00  0.000000000E+00  0.100000000E+01
     72  0.000000000E+00  0.100000000E+01  0.666666687E+00
     73  0.000000000E+00  0.100000000E+01  0.333333343E+00
     74  0.000000000E+00  0.100000000E+01  0.000000000E+00
     75  0.333333343E+00  0.666666687E+00  0.100000000E+01
     76  0.666666687E+00  0.666666687E+00  0.100000000E+01
     77  0.100000000E+01  0.666666687E+00  0.100000000E+01
     78  0.333333343E+00  0.333333343E+00  0.100000000E+01
     79  0.333333343E+00  0.000000000E+00  0.100000000E+01
     80  0.666666687E+00  0.333333343E+00  0.100000000E+01
     81  0.100000000E+01  0.333333343E+00  0.100000000E+01
     82  0.666666687E+00  0.000000000E+00  0.100000000E+01
     83  0.100000000E+01  0.000000000E+00  0.100000000E+01
     84  0.333333343E+00  0.100000000E+01  0.666666687E+00
     85  0.666666687E+00  0.100000000E+01  0.666666687E+00
     86  0.100000000E+01  0.100000000E+01  0.666666687E+00
     87  0.333333343E+00  0.100000000E+01  0.333333343E+00
     88  0.333333343E+00  0.100000000E+01  0.000000000E+00
     89  0.666666687E+00  0.100000000E+01  0.333333343E+00
     90  0.100000000E+01  0.100000000E+01  0.333333343E+00
     91  0.666666687E+00  0.100000000E+01  0.000000000E+00
     92  0.100000000E+01  0.100000000E+01  0.000000000E+00
     93  0.000000000E+00  0.666666687E+00  0.666666687E+00
     94  0.333333343E+00  0.666666687E+00  0.666666687E+00
     95  0.666666687E+00  0.666666687E+00  0.666666687E+00
     96  0.100000000E+01  0.666666687E+00  0.666666687E+00
     97  0.333333343E+00  0.333333343E+00  0.666666687E+00
     98  0.000000000E+00  0.333333343E+00  0.666666687E+00
     99  0.333333343E+00  0.000000000E+00  0.666666687E+00
    100  0.000000000E+00  0.000000000E+00  0.666666687E+00
    101  0.000000000E+00  0.666666687E+00  0.333333343E+00
    102  0.000000000E+00  0.666666687E+00  0.000000000E+00
    103  0.333333343E+00  0.666666687E+00  0.333333343E+00
    104  0.333333343E+00  0.666666687E+00  0.000000000E+00
    105  0.666666687E+00  0.333333343E+00  0.666666687E+00
    106  0.100000000E+01  0.333333343E+00  0.666666687E+00
    107  0.666666687E+00  0.000000000E+00  0.666666687E+00
    108  0.100000000E+01  0.000000000E+00  0.666666687E+00
    109  0.666666687E+00  0.666666687E+00  0.333333343E+00
    110  0.100000000E+01  0.666666687E+00  0.333333343E+00
    111  0.666666687E+00  0.666666687E+00  0.000000000E+00
    112  0.100000000E+01  0.666666687E+00  0.000000000E+00
    113  0.000000000E+00  0.333333343E+00  0.333333343E+00
    114  0.000000000E+00  0.000000000E+00  0.333333343E+00
    115  0.000000000E+00  0.333333343E+00  0.000000000E+00
    116  0.000000000E+00  0.000000000E+00  0.000000000E+00
    117  0.333333343E+00  0.333333343E+00  0.333333343E+00
    118  0.666666687E+00  0.333333343E+00  0.333333343E+00
    119  0.100000000E+01  0.333333343E+00  0.333333343E+00
    120  0.666666687E+00  0.000000000E+00  0.333333343E+00
    121  0.333333343E+00  0.000000000E+00  0.333333343E+00
    122  0.333333343E+00  0.333333343E+00  0.000000000E+00
    123  0.666666687E+00  0.333333343E+00  0.000000000E+00
    124  0.100000000E+01  0.000000000E+00  0.333333343E+00
    125  0.100000000E+01  0.333333343E+00  0.000000000E+00
    126  0.333333343E+00  0.000000000E+00  0.000000000E+00
    127  0.100000000E+01  0.000000000E+00  0.000000000E+00
    128  0.666666687E+00  0.000000000E+00  0.000000000E+00
*echo on
c
elements
  1-54 type l3disop nonlinear material solid center_output,
       short order 2x2x2
  55-63 type inter_8 nonlinear material ppr_matl order '2x2gs'   
c
incidences 
*echo off
       1     116     126     122     115     114     121     117     113
       2     126     128     123     122     121     120     118     117
       3     128     127     125     123     120     124     119     118
       4     115     122     104     102     113     117     103     101
       5     122     123     111     104     117     118     109     103
       6     123     125     112     111     118     119     110     109
       7     102     104      88      74     101     103      87      73
       8     104     111      91      88     103     109      89      87
       9     111     112      92      91     109     110      90      89
      10     114     121     117     113     100      99      97      98
      11     121     120     118     117      99     107     105      97
      12     120     124     119     118     107     108     106     105
      13     113     117     103     101      98      97      94      93
      14     117     118     109     103      97     105      95      94
      15     118     119     110     109     105     106      96      95
      16     101     103      87      73      93      94      84      72
      17     103     109      89      87      94      95      85      84
      18     109     110      90      89      95      96      86      85
      19     100      99      97      98      71      79      78      70
      20      99     107     105      97      79      82      80      78
      21     107     108     106     105      82      83      81      80
      22      98      97      94      93      70      78      75      69
      23      97     105      95      94      78      80      76      75
      24     105     106      96      95      80      81      77      76
      25      93      94      84      72      69      75      66      65
      26      94      95      85      84      75      76      67      66
      27      95      96      86      85      76      77      68      67
      28      55      60      59      54      39      44      43      38
      29      60      63      61      59      44      47      45      43
      30      63      64      62      61      47      48      46      45
      31      54      59      56      53      38      43      40      37
      32      59      61      57      56      43      45      41      40
      33      61      62      58      57      45      46      42      41
      34      53      56      50      49      37      40      34      33
      35      56      57      51      50      40      41      35      34
      36      57      58      52      51      41      42      36      35
      37      39      44      43      38      23      28      27      22
      38      44      47      45      43      28      31      29      27
      39      47      48      46      45      31      32      30      29
      40      38      43      40      37      22      27      24      21
      41      43      45      41      40      27      29      25      24
      42      45      46      42      41      29      30      26      25
      43      37      40      34      33      21      24      18      17
      44      40      41      35      34      24      25      19      18
      45      41      42      36      35      25      26      20      19
      46      23      28      27      22       7      12      11       6
      47      28      31      29      27      12      15      13      11
      48      31      32      30      29      15      16      14      13
      49      22      27      24      21       6      11       8       5
      50      27      29      25      24      11      13       9       8
      51      29      30      26      25      13      14      10       9
      52      21      24      18      17       5       8       2       1
      53      24      25      19      18       8       9       3       2
      54      25      26      20      19       9      10       4       3
      55      71      79      78      70      55      60      59      54
      56      79      82      80      78      60      63      61      59
      57      82      83      81      80      63      64      62      61
      58      70      78      75      69      54      59      56      53
      59      78      80      76      75      59      61      57      56
      60      80      81      77      76      61      62      58      57
      61      69      75      66      65      53      56      50      49
      62      75      76      67      66      56      57      51      50
      63      76      77      68      67      57      58      52      51
*echo on
c
blocking $ scalar: only sparse solver allowed
       1      54     1
       2       9     55
c
constraints
  plane z=0 symmetry
  plane x=0 symmetry
  plane y=0 symmetry
c
loading unit_axial_z
  element loads
   46-54 face 2 pressure -1.0
c
loading test
  nonlinear
    step 1-3 unit_axial_z 1.65  $ peak traction is 5.0. load almost to peak
c
nonlinear analysis parameters
   solution technique direct sparse
   maximum iterations 10
   minimum iterations 1 
   convergence test norm res tol 0.001 $ quite tight 
   time step  1.0e6
   trace solution on    
   adaptive solution off 
   batch messages off
   extrapolate off        
   material messages off
   show details on     
   consistent q-matrix off
c
 crack growth parameters $ elements not killed. just to get output
c                          of their status after each step
   type of crack growth cohesive
   ppr displacement fracture for extinction 0.9
   print status on order elements 55-63
   force release type steps
   release steps 5
c
compute displacements for loading test step 1
output wide displacements for nodes 71 55, 83 64, 65 49, 68 52
output wide displacements for nodes 1-16
output wide stresses 7 52 9 54
c
compute displacements for loading test step 2
output wide displacements for nodes  71 55, 83 64, 65 49, 68 52
output wide displacements for nodes 1-16
output wide stresses  7 52 9 54
c
compute displacements for loading test step 3
output wide displacements for nodes  71 55, 83 64, 65 49, 68 52
output wide displacements for nodes 1-16
output wide stresses  7 52 9 54
stop

!
!      test rigid contact of a body inside a cylinder
!      expanding outward under pressure and contacting
!      the cylinder
!
!      model is a piece of a right circular cylinder with
!      inner radius 10.0, outer radius 11.0
!      planes x,y,z= 0 are symmetry
!
!      model made by:
!         1) sweep a line segment 10 <= x <= 11 about z for +30-degrees
!            to create an arc surface in x-y plane
!         2) sweep the arc surface +5 units in +z to make a parial cylindrical
!            wall. Do this in 3 segements.
!
!      apply increasing pressure to inner surface of those elements only
!      in solid one to create a nonuniform and increasing contact area
!      with pressure
!
!      the rigid contact surface is a cylinder with radius 11.1
!
!      solution takes < 0.2 secs on 4 threads (2017 server) 
!
 structure cylinder
! 
  material elastic
    properties bilinear e 1.0e05 nu 0.3 yld_pt 1.0e20
! 
  number nodes 228 elements 90
!
  elements
    1-90 type l3disop linear material elastic,
      order 2x2x2 bbar center_output short
!
 coordinates
*echo off
      1  0.100000000E+02  0.000000000E+00  0.000000000E+00
      2  0.996194649E+01  0.871557593E+00  0.000000000E+00
      3  0.984807777E+01  0.173648226E+01  0.000000000E+00
      4  0.965925789E+01  0.258819056E+01  0.000000000E+00
      5  0.939692593E+01  0.342020178E+01  0.000000000E+00
      6  0.906307793E+01  0.422618294E+01  0.000000000E+00
      7  0.866025352E+01  0.500000000E+01  0.000000000E+00
      8  0.100000000E+02  0.000000000E+00  0.100000000E+01
      9  0.996194649E+01  0.871557593E+00  0.100000000E+01
     10  0.984807777E+01  0.173648226E+01  0.100000000E+01
     11  0.965925789E+01  0.258819056E+01  0.100000000E+01
     12  0.939692593E+01  0.342020178E+01  0.100000000E+01
     13  0.906307793E+01  0.422618294E+01  0.100000000E+01
     14  0.866025352E+01  0.500000000E+01  0.100000000E+01
     15  0.100000000E+02  0.000000000E+00  0.200000000E+01
     16  0.996194649E+01  0.871557593E+00  0.200000000E+01
     17  0.984807777E+01  0.173648226E+01  0.200000000E+01
     18  0.965925789E+01  0.258819056E+01  0.200000000E+01
     19  0.939692593E+01  0.342020178E+01  0.200000000E+01
     20  0.906307793E+01  0.422618294E+01  0.200000000E+01
     21  0.866025352E+01  0.500000000E+01  0.200000000E+01
     22  0.100000000E+02  0.000000000E+00  0.300000000E+01
     23  0.996194649E+01  0.871557593E+00  0.300000000E+01
     24  0.984807777E+01  0.173648226E+01  0.300000000E+01
     25  0.965925789E+01  0.258819056E+01  0.300000000E+01
     26  0.939692593E+01  0.342020178E+01  0.300000000E+01
     27  0.906307793E+01  0.422618294E+01  0.300000000E+01
     28  0.866025352E+01  0.500000000E+01  0.300000000E+01
     29  0.100000000E+02  0.000000000E+00  0.400000000E+01
     30  0.996194649E+01  0.871557593E+00  0.400000000E+01
     31  0.984807777E+01  0.173648226E+01  0.400000000E+01
     32  0.965925789E+01  0.258819056E+01  0.400000000E+01
     33  0.939692593E+01  0.342020178E+01  0.400000000E+01
     34  0.906307793E+01  0.422618294E+01  0.400000000E+01
     35  0.866025352E+01  0.500000000E+01  0.400000000E+01
     36  0.100000000E+02  0.000000000E+00  0.500000000E+01
     37  0.996194649E+01  0.871557593E+00  0.500000000E+01
     38  0.984807777E+01  0.173648226E+01  0.500000000E+01
     39  0.965925789E+01  0.258819056E+01  0.500000000E+01
     40  0.939692593E+01  0.342020178E+01  0.500000000E+01
     41  0.906307793E+01  0.422618294E+01  0.500000000E+01
     42  0.866025352E+01  0.500000000E+01  0.500000000E+01
     43  0.110000000E+02  0.000000000E+00  0.000000000E+00
     44  0.109581413E+02  0.958713293E+00  0.000000000E+00
     45  0.108328848E+02  0.191013014E+01  0.000000000E+00
     46  0.106251841E+02  0.284700966E+01  0.000000000E+00
     47  0.103366184E+02  0.376222181E+01  0.000000000E+00
     48  0.996938610E+01  0.464880085E+01  0.000000000E+00
     49  0.952627945E+01  0.550000000E+01  0.000000000E+00
     50  0.110000000E+02  0.000000000E+00  0.100000000E+01
     51  0.109581413E+02  0.958713293E+00  0.100000000E+01
     52  0.108328848E+02  0.191013014E+01  0.100000000E+01
     53  0.106251841E+02  0.284700966E+01  0.100000000E+01
     54  0.103366184E+02  0.376222181E+01  0.100000000E+01
     55  0.996938610E+01  0.464880085E+01  0.100000000E+01
     56  0.952627945E+01  0.550000000E+01  0.100000000E+01
     57  0.110000000E+02  0.000000000E+00  0.200000000E+01
     58  0.109581413E+02  0.958713293E+00  0.200000000E+01
     59  0.108328848E+02  0.191013014E+01  0.200000000E+01
     60  0.106251841E+02  0.284700966E+01  0.200000000E+01
     61  0.103366184E+02  0.376222181E+01  0.200000000E+01
     62  0.996938610E+01  0.464880085E+01  0.200000000E+01
     63  0.952627945E+01  0.550000000E+01  0.200000000E+01
     64  0.110000000E+02  0.000000000E+00  0.300000000E+01
     65  0.109581413E+02  0.958713293E+00  0.300000000E+01
     66  0.108328848E+02  0.191013014E+01  0.300000000E+01
     67  0.106251841E+02  0.284700966E+01  0.300000000E+01
     68  0.103366184E+02  0.376222181E+01  0.300000000E+01
     69  0.996938610E+01  0.464880085E+01  0.300000000E+01
     70  0.952627945E+01  0.550000000E+01  0.300000000E+01
     71  0.110000000E+02  0.000000000E+00  0.400000000E+01
     72  0.109581413E+02  0.958713293E+00  0.400000000E+01
     73  0.108328848E+02  0.191013014E+01  0.400000000E+01
     74  0.106251841E+02  0.284700966E+01  0.400000000E+01
     75  0.103366184E+02  0.376222181E+01  0.400000000E+01
     76  0.996938610E+01  0.464880085E+01  0.400000000E+01
     77  0.952627945E+01  0.550000000E+01  0.400000000E+01
     78  0.110000000E+02  0.000000000E+00  0.500000000E+01
     79  0.109581413E+02  0.958713293E+00  0.500000000E+01
     80  0.108328848E+02  0.191013014E+01  0.500000000E+01
     81  0.106251841E+02  0.284700966E+01  0.500000000E+01
     82  0.103366184E+02  0.376222181E+01  0.500000000E+01
     83  0.996938610E+01  0.464880085E+01  0.500000000E+01
     84  0.952627945E+01  0.550000000E+01  0.500000000E+01
     85  0.819151974E+01  0.573576450E+01  0.000000000E+00
     86  0.766044426E+01  0.642787647E+01  0.000000000E+00
     87  0.707106733E+01  0.707106781E+01  0.000000000E+00
     88  0.642787552E+01  0.766044474E+01  0.000000000E+00
     89  0.573576403E+01  0.819152069E+01  0.000000000E+00
     90  0.499999952E+01  0.866025448E+01  0.000000000E+00
     91  0.819151974E+01  0.573576450E+01  0.100000000E+01
     92  0.766044426E+01  0.642787647E+01  0.100000000E+01
     93  0.707106733E+01  0.707106781E+01  0.100000000E+01
     94  0.642787552E+01  0.766044474E+01  0.100000000E+01
     95  0.573576403E+01  0.819152069E+01  0.100000000E+01
     96  0.499999952E+01  0.866025448E+01  0.100000000E+01
     97  0.819151974E+01  0.573576450E+01  0.200000000E+01
     98  0.766044426E+01  0.642787647E+01  0.200000000E+01
     99  0.707106733E+01  0.707106781E+01  0.200000000E+01
    100  0.642787552E+01  0.766044474E+01  0.200000000E+01
    101  0.573576403E+01  0.819152069E+01  0.200000000E+01
    102  0.499999952E+01  0.866025448E+01  0.200000000E+01
    103  0.819151974E+01  0.573576450E+01  0.300000000E+01
    104  0.766044426E+01  0.642787647E+01  0.300000000E+01
    105  0.707106733E+01  0.707106781E+01  0.300000000E+01
    106  0.642787552E+01  0.766044474E+01  0.300000000E+01
    107  0.573576403E+01  0.819152069E+01  0.300000000E+01
    108  0.499999952E+01  0.866025448E+01  0.300000000E+01
    109  0.819151974E+01  0.573576450E+01  0.400000000E+01
    110  0.766044426E+01  0.642787647E+01  0.400000000E+01
    111  0.707106733E+01  0.707106781E+01  0.400000000E+01
    112  0.642787552E+01  0.766044474E+01  0.400000000E+01
    113  0.573576403E+01  0.819152069E+01  0.400000000E+01
    114  0.499999952E+01  0.866025448E+01  0.400000000E+01
    115  0.819151974E+01  0.573576450E+01  0.500000000E+01
    116  0.766044426E+01  0.642787647E+01  0.500000000E+01
    117  0.707106733E+01  0.707106781E+01  0.500000000E+01
    118  0.642787552E+01  0.766044474E+01  0.500000000E+01
    119  0.573576403E+01  0.819152069E+01  0.500000000E+01
    120  0.499999952E+01  0.866025448E+01  0.500000000E+01
    121  0.901067257E+01  0.630934095E+01  0.000000000E+00
    122  0.842648888E+01  0.707066345E+01  0.000000000E+00
    123  0.777817440E+01  0.777817488E+01  0.000000000E+00
    124  0.707066345E+01  0.842648888E+01  0.000000000E+00
    125  0.630934048E+01  0.901067257E+01  0.000000000E+00
    126  0.549999952E+01  0.952627945E+01  0.000000000E+00
    127  0.901067257E+01  0.630934095E+01  0.100000000E+01
    128  0.842648888E+01  0.707066345E+01  0.100000000E+01
    129  0.777817440E+01  0.777817488E+01  0.100000000E+01
    130  0.707066345E+01  0.842648888E+01  0.100000000E+01
    131  0.630934048E+01  0.901067257E+01  0.100000000E+01
    132  0.549999952E+01  0.952627945E+01  0.100000000E+01
    133  0.901067257E+01  0.630934095E+01  0.200000000E+01
    134  0.842648888E+01  0.707066345E+01  0.200000000E+01
    135  0.777817440E+01  0.777817488E+01  0.200000000E+01
    136  0.707066345E+01  0.842648888E+01  0.200000000E+01
    137  0.630934048E+01  0.901067257E+01  0.200000000E+01
    138  0.549999952E+01  0.952627945E+01  0.200000000E+01
    139  0.901067257E+01  0.630934095E+01  0.300000000E+01
    140  0.842648888E+01  0.707066345E+01  0.300000000E+01
    141  0.777817440E+01  0.777817488E+01  0.300000000E+01
    142  0.707066345E+01  0.842648888E+01  0.300000000E+01
    143  0.630934048E+01  0.901067257E+01  0.300000000E+01
    144  0.549999952E+01  0.952627945E+01  0.300000000E+01
    145  0.901067257E+01  0.630934095E+01  0.400000000E+01
    146  0.842648888E+01  0.707066345E+01  0.400000000E+01
    147  0.777817440E+01  0.777817488E+01  0.400000000E+01
    148  0.707066345E+01  0.842648888E+01  0.400000000E+01
    149  0.630934048E+01  0.901067257E+01  0.400000000E+01
    150  0.549999952E+01  0.952627945E+01  0.400000000E+01
    151  0.901067257E+01  0.630934095E+01  0.500000000E+01
    152  0.842648888E+01  0.707066345E+01  0.500000000E+01
    153  0.777817440E+01  0.777817488E+01  0.500000000E+01
    154  0.707066345E+01  0.842648888E+01  0.500000000E+01
    155  0.630934048E+01  0.901067257E+01  0.500000000E+01
    156  0.549999952E+01  0.952627945E+01  0.500000000E+01
    157  0.422618198E+01  0.906307888E+01  0.000000000E+00
    158  0.342020082E+01  0.939692688E+01  0.000000000E+00
    159  0.258818984E+01  0.965925884E+01  0.000000000E+00
    160  0.173648071E+01  0.984807777E+01  0.000000000E+00
    161  0.871556938E+00  0.996194744E+01  0.000000000E+00
    162 -0.624105439E-06  0.100000000E+02  0.000000000E+00
    163  0.422618198E+01  0.906307888E+01  0.100000000E+01
    164  0.342020082E+01  0.939692688E+01  0.100000000E+01
    165  0.258818984E+01  0.965925884E+01  0.100000000E+01
    166  0.173648071E+01  0.984807777E+01  0.100000000E+01
    167  0.871556938E+00  0.996194744E+01  0.100000000E+01
    168 -0.624105439E-06  0.100000000E+02  0.100000000E+01
    169  0.422618198E+01  0.906307888E+01  0.200000000E+01
    170  0.342020082E+01  0.939692688E+01  0.200000000E+01
    171  0.258818984E+01  0.965925884E+01  0.200000000E+01
    172  0.173648071E+01  0.984807777E+01  0.200000000E+01
    173  0.871556938E+00  0.996194744E+01  0.200000000E+01
    174 -0.624105439E-06  0.100000000E+02  0.200000000E+01
    175  0.422618198E+01  0.906307888E+01  0.300000000E+01
    176  0.342020082E+01  0.939692688E+01  0.300000000E+01
    177  0.258818984E+01  0.965925884E+01  0.300000000E+01
    178  0.173648071E+01  0.984807777E+01  0.300000000E+01
    179  0.871556938E+00  0.996194744E+01  0.300000000E+01
    180 -0.624105439E-06  0.100000000E+02  0.300000000E+01
    181  0.422618198E+01  0.906307888E+01  0.400000000E+01
    182  0.342020082E+01  0.939692688E+01  0.400000000E+01
    183  0.258818984E+01  0.965925884E+01  0.400000000E+01
    184  0.173648071E+01  0.984807777E+01  0.400000000E+01
    185  0.871556938E+00  0.996194744E+01  0.400000000E+01
    186 -0.624105439E-06  0.100000000E+02  0.400000000E+01
    187  0.422618198E+01  0.906307888E+01  0.500000000E+01
    188  0.342020082E+01  0.939692688E+01  0.500000000E+01
    189  0.258818984E+01  0.965925884E+01  0.500000000E+01
    190  0.173648071E+01  0.984807777E+01  0.500000000E+01
    191  0.871556938E+00  0.996194744E+01  0.500000000E+01
    192 -0.624105439E-06  0.100000000E+02  0.500000000E+01
    193  0.464880085E+01  0.996938610E+01  0.000000000E+00
    194  0.376222110E+01  0.103366194E+02  0.000000000E+00
    195  0.284700942E+01  0.106251841E+02  0.000000000E+00
    196  0.191012979E+01  0.108328857E+02  0.000000000E+00
    197  0.958712935E+00  0.109581423E+02  0.000000000E+00
    198 -0.686515989E-06  0.110000000E+02  0.000000000E+00
    199  0.464880085E+01  0.996938610E+01  0.100000000E+01
    200  0.376222110E+01  0.103366194E+02  0.100000000E+01
    201  0.284700942E+01  0.106251841E+02  0.100000000E+01
    202  0.191012979E+01  0.108328857E+02  0.100000000E+01
    203  0.958712935E+00  0.109581423E+02  0.100000000E+01
    204 -0.686515989E-06  0.110000000E+02  0.100000000E+01
    205  0.464880085E+01  0.996938610E+01  0.200000000E+01
    206  0.376222110E+01  0.103366194E+02  0.200000000E+01
    207  0.284700942E+01  0.106251841E+02  0.200000000E+01
    208  0.191012979E+01  0.108328857E+02  0.200000000E+01
    209  0.958712935E+00  0.109581423E+02  0.200000000E+01
    210 -0.686515989E-06  0.110000000E+02  0.200000000E+01
    211  0.464880085E+01  0.996938610E+01  0.300000000E+01
    212  0.376222110E+01  0.103366194E+02  0.300000000E+01
    213  0.284700942E+01  0.106251841E+02  0.300000000E+01
    214  0.191012979E+01  0.108328857E+02  0.300000000E+01
    215  0.958712935E+00  0.109581423E+02  0.300000000E+01
    216 -0.686515989E-06  0.110000000E+02  0.300000000E+01
    217  0.464880085E+01  0.996938610E+01  0.400000000E+01
    218  0.376222110E+01  0.103366194E+02  0.400000000E+01
    219  0.284700942E+01  0.106251841E+02  0.400000000E+01
    220  0.191012979E+01  0.108328857E+02  0.400000000E+01
    221  0.958712935E+00  0.109581423E+02  0.400000000E+01
    222 -0.686515989E-06  0.110000000E+02  0.400000000E+01
    223  0.464880085E+01  0.996938610E+01  0.500000000E+01
    224  0.376222110E+01  0.103366194E+02  0.500000000E+01
    225  0.284700942E+01  0.106251841E+02  0.500000000E+01
    226  0.191012979E+01  0.108328857E+02  0.500000000E+01
    227  0.958712935E+00  0.109581423E+02  0.500000000E+01
    228 -0.686515989E-06  0.110000000E+02  0.500000000E+01
 incidences 
       1       1       2       9       8      43      44      51      50
       2       2       3      10       9      44      45      52      51
       3       3       4      11      10      45      46      53      52
       4       4       5      12      11      46      47      54      53
       5       5       6      13      12      47      48      55      54
       6       6       7      14      13      48      49      56      55
       7       8       9      16      15      50      51      58      57
       8       9      10      17      16      51      52      59      58
       9      10      11      18      17      52      53      60      59
      10      11      12      19      18      53      54      61      60
      11      12      13      20      19      54      55      62      61
      12      13      14      21      20      55      56      63      62
      13      15      16      23      22      57      58      65      64
      14      16      17      24      23      58      59      66      65
      15      17      18      25      24      59      60      67      66
      16      18      19      26      25      60      61      68      67
      17      19      20      27      26      61      62      69      68
      18      20      21      28      27      62      63      70      69
      19      22      23      30      29      64      65      72      71
      20      23      24      31      30      65      66      73      72
      21      24      25      32      31      66      67      74      73
      22      25      26      33      32      67      68      75      74
      23      26      27      34      33      68      69      76      75
      24      27      28      35      34      69      70      77      76
      25      29      30      37      36      71      72      79      78
      26      30      31      38      37      72      73      80      79
      27      31      32      39      38      73      74      81      80
      28      32      33      40      39      74      75      82      81
      29      33      34      41      40      75      76      83      82
      30      34      35      42      41      76      77      84      83
      31       7      85      91      14      49     121     127      56
      32      85      86      92      91     121     122     128     127
      33      86      87      93      92     122     123     129     128
      34      87      88      94      93     123     124     130     129
      35      88      89      95      94     124     125     131     130
      36      89      90      96      95     125     126     132     131
      37      14      91      97      21      56     127     133      63
      38      91      92      98      97     127     128     134     133
      39      92      93      99      98     128     129     135     134
      40      93      94     100      99     129     130     136     135
      41      94      95     101     100     130     131     137     136
      42      95      96     102     101     131     132     138     137
      43      21      97     103      28      63     133     139      70
      44      97      98     104     103     133     134     140     139
      45      98      99     105     104     134     135     141     140
      46      99     100     106     105     135     136     142     141
      47     100     101     107     106     136     137     143     142
      48     101     102     108     107     137     138     144     143
      49      28     103     109      35      70     139     145      77
      50     103     104     110     109     139     140     146     145
      51     104     105     111     110     140     141     147     146
      52     105     106     112     111     141     142     148     147
      53     106     107     113     112     142     143     149     148
      54     107     108     114     113     143     144     150     149
      55      35     109     115      42      77     145     151      84
      56     109     110     116     115     145     146     152     151
      57     110     111     117     116     146     147     153     152
      58     111     112     118     117     147     148     154     153
      59     112     113     119     118     148     149     155     154
      60     113     114     120     119     149     150     156     155
      61      90     157     163      96     126     193     199     132
      62     157     158     164     163     193     194     200     199
      63     158     159     165     164     194     195     201     200
      64     159     160     166     165     195     196     202     201
      65     160     161     167     166     196     197     203     202
      66     161     162     168     167     197     198     204     203
      67      96     163     169     102     132     199     205     138
      68     163     164     170     169     199     200     206     205
      69     164     165     171     170     200     201     207     206
      70     165     166     172     171     201     202     208     207
      71     166     167     173     172     202     203     209     208
      72     167     168     174     173     203     204     210     209
      73     102     169     175     108     138     205     211     144
      74     169     170     176     175     205     206     212     211
      75     170     171     177     176     206     207     213     212
      76     171     172     178     177     207     208     214     213
      77     172     173     179     178     208     209     215     214
      78     173     174     180     179     209     210     216     215
      79     108     175     181     114     144     211     217     150
      80     175     176     182     181     211     212     218     217
      81     176     177     183     182     212     213     219     218
      82     177     178     184     183     213     214     220     219
      83     178     179     185     184     214     215     221     220
      84     179     180     186     185     215     216     222     221
      85     114     181     187     120     150     217     223     156
      86     181     182     188     187     217     218     224     223
      87     182     183     189     188     218     219     225     224
      88     183     184     190     189     219     220     226     225
      89     184     185     191     190     220     221     227     226
      90     185     186     192     191     221     222     228     227
! 
*echo on
 blocking automatic size = 10
! 
 constraints
   plane z=0 symmetry
   plane y=0 symmetry
   plane x=0 symmetry
!
 contact surface
   surface 1 cylinder
   stiffness 1.0e8
   point 0.0 0.0 -1.0
   direction 0.0 0.0 1.0
   radius 11.1
   length 50.0
   inside
!
 loading partial  
   element loads
         1-30 face 1 pressure 1.000
!
 loading test
   nonlinear
    step 1 partial 1.0
    step 2-10 partial 0.5
! 
 nonlinear analysis parameters
   solution technique sparse direct 
   time step 1.0e06 
   maximum iterations 20 $  global Newton iterations
   minimum iterations 1
   extrapolate on
   line search off
   divergence check on
   convergence test norm res tol 0.01
   nonconvergent solutions stop
   adaptive on  $ global Newton iterations
   batch messages off
   wall time limit off
   material messages off
   bbar stabilization factor 0.0
   consistent q-matrix on
   trace solution on
   display tied mesh mpcs off
   user_routine off
! 
 compute displacements for loading test step 10
 output displacements 57 228
! 
 stop

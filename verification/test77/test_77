!
!
!       cantilever beam with linear elastic material.
!
!       1 x 1 cross section inY-Z plane, 5 units long in X.
!
!       loading to cause very large 3D end displacements
!       and large 3D rotations of the co-rotational
!       system at each material point.
!
!       check strain output which uses the new transformation
!       implemented in July 2014.
!
!       WARP3D strains now match values output by Abaqus.
!
!       WARP3D strains are now the sum of co-rotational increments
!       rotated to fixed-global at output time.
!
!       Abaqus continually rotates accumulated strains at
!       each load step.
!
!       see Abaqus input file for same problem in the directory.
!
!       Use 100 steps. Abaqus and WARP3D both have convergence
!       issues 15-50 load steps since increments are very large.
!       
structure bar

material steel 
  properties bilinear e 100 nu 0.3 yld_pt 1.0e20

number of nodes  171 elements  20
c

elements
  
 1-20  type q3disop nonlinear material steel,
   order 2x2x2  short
c
coordinates
*echo off
      1  0.000000000E+00  0.000000000E+00  0.000000000E+00
      2  0.500000000E+00  0.000000000E+00  0.000000000E+00
      3  0.100000000E+01  0.000000000E+00  0.000000000E+00
      4  0.150000000E+01  0.000000000E+00  0.000000000E+00
      5  0.200000000E+01  0.000000000E+00  0.000000000E+00
      6  0.250000000E+01  0.000000000E+00  0.000000000E+00
      7  0.300000000E+01  0.000000000E+00  0.000000000E+00
      8  0.350000024E+01  0.000000000E+00  0.000000000E+00
      9  0.400000000E+01  0.000000000E+00  0.000000000E+00
     10  0.450000000E+01  0.000000000E+00  0.000000000E+00
     11  0.500000000E+01  0.000000000E+00  0.000000000E+00
     12  0.000000000E+00  0.250000000E+00  0.000000000E+00
     13  0.100000000E+01  0.250000000E+00  0.000000000E+00
     14  0.200000000E+01  0.250000000E+00  0.000000000E+00
     15  0.300000000E+01  0.250000000E+00  0.000000000E+00
     16  0.400000000E+01  0.250000000E+00  0.000000000E+00
     17  0.500000000E+01  0.250000000E+00  0.000000000E+00
     18  0.000000000E+00  0.500000000E+00  0.000000000E+00
     19  0.500000000E+00  0.500000000E+00  0.000000000E+00
     20  0.100000000E+01  0.500000000E+00  0.000000000E+00
     21  0.150000000E+01  0.500000000E+00  0.000000000E+00
     22  0.200000000E+01  0.500000000E+00  0.000000000E+00
     23  0.250000000E+01  0.500000000E+00  0.000000000E+00
     24  0.300000000E+01  0.500000000E+00  0.000000000E+00
     25  0.350000024E+01  0.500000000E+00  0.000000000E+00
     26  0.400000000E+01  0.500000000E+00  0.000000000E+00
     27  0.450000000E+01  0.500000000E+00  0.000000000E+00
     28  0.500000000E+01  0.500000000E+00  0.000000000E+00
     29  0.000000000E+00  0.750000000E+00  0.000000000E+00
     30  0.100000000E+01  0.750000000E+00  0.000000000E+00
     31  0.200000000E+01  0.750000000E+00  0.000000000E+00
     32  0.300000000E+01  0.750000000E+00  0.000000000E+00
     33  0.400000000E+01  0.750000000E+00  0.000000000E+00
     34  0.500000000E+01  0.750000000E+00  0.000000000E+00
     35  0.000000000E+00  0.100000000E+01  0.000000000E+00
     36  0.500000000E+00  0.100000000E+01  0.000000000E+00
     37  0.100000000E+01  0.100000000E+01  0.000000000E+00
     38  0.150000000E+01  0.100000000E+01  0.000000000E+00
     39  0.200000000E+01  0.100000000E+01  0.000000000E+00
     40  0.250000000E+01  0.100000000E+01  0.000000000E+00
     41  0.300000000E+01  0.100000000E+01  0.000000000E+00
     42  0.350000024E+01  0.100000000E+01  0.000000000E+00
     43  0.400000000E+01  0.100000000E+01  0.000000000E+00
     44  0.450000000E+01  0.100000000E+01  0.000000000E+00
     45  0.500000000E+01  0.100000000E+01  0.000000000E+00
     46  0.000000000E+00  0.000000000E+00  0.250000000E+00
     47  0.100000000E+01  0.000000000E+00  0.250000000E+00
     48  0.200000000E+01  0.000000000E+00  0.250000000E+00
     49  0.300000000E+01  0.000000000E+00  0.250000000E+00
     50  0.400000000E+01  0.000000000E+00  0.250000000E+00
     51  0.500000000E+01  0.000000000E+00  0.250000000E+00
     52  0.000000000E+00  0.500000000E+00  0.250000000E+00
     53  0.100000000E+01  0.500000000E+00  0.250000000E+00
     54  0.200000000E+01  0.500000000E+00  0.250000000E+00
     55  0.300000000E+01  0.500000000E+00  0.250000000E+00
     56  0.400000000E+01  0.500000000E+00  0.250000000E+00
     57  0.500000000E+01  0.500000000E+00  0.250000000E+00
     58  0.000000000E+00  0.100000000E+01  0.250000000E+00
     59  0.100000000E+01  0.100000000E+01  0.250000000E+00
     60  0.200000000E+01  0.100000000E+01  0.250000000E+00
     61  0.300000000E+01  0.100000000E+01  0.250000000E+00
     62  0.400000000E+01  0.100000000E+01  0.250000000E+00
     63  0.500000000E+01  0.100000000E+01  0.250000000E+00
     64  0.000000000E+00  0.000000000E+00  0.500000000E+00
     65  0.500000000E+00  0.000000000E+00  0.500000000E+00
     66  0.100000000E+01  0.000000000E+00  0.500000000E+00
     67  0.150000000E+01  0.000000000E+00  0.500000000E+00
     68  0.200000000E+01  0.000000000E+00  0.500000000E+00
     69  0.250000000E+01  0.000000000E+00  0.500000000E+00
     70  0.300000000E+01  0.000000000E+00  0.500000000E+00
     71  0.350000024E+01  0.000000000E+00  0.500000000E+00
     72  0.400000000E+01  0.000000000E+00  0.500000000E+00
     73  0.450000000E+01  0.000000000E+00  0.500000000E+00
     74  0.500000000E+01  0.000000000E+00  0.500000000E+00
     75  0.000000000E+00  0.250000000E+00  0.500000000E+00
     76  0.100000000E+01  0.250000000E+00  0.500000000E+00
     77  0.200000000E+01  0.250000000E+00  0.500000000E+00
     78  0.300000000E+01  0.250000000E+00  0.500000000E+00
     79  0.400000000E+01  0.250000000E+00  0.500000000E+00
     80  0.500000000E+01  0.250000000E+00  0.500000000E+00
     81  0.000000000E+00  0.500000000E+00  0.500000000E+00
     82  0.500000000E+00  0.500000000E+00  0.500000000E+00
     83  0.100000000E+01  0.500000000E+00  0.500000000E+00
     84  0.150000000E+01  0.500000000E+00  0.500000000E+00
     85  0.200000000E+01  0.500000000E+00  0.500000000E+00
     86  0.250000000E+01  0.500000000E+00  0.500000000E+00
     87  0.300000000E+01  0.500000000E+00  0.500000000E+00
     88  0.350000024E+01  0.500000000E+00  0.500000000E+00
     89  0.400000000E+01  0.500000000E+00  0.500000000E+00
     90  0.450000000E+01  0.500000000E+00  0.500000000E+00
     91  0.500000000E+01  0.500000000E+00  0.500000000E+00
     92  0.000000000E+00  0.750000000E+00  0.500000000E+00
     93  0.100000000E+01  0.750000000E+00  0.500000000E+00
     94  0.200000000E+01  0.750000000E+00  0.500000000E+00
     95  0.300000000E+01  0.750000000E+00  0.500000000E+00
     96  0.400000000E+01  0.750000000E+00  0.500000000E+00
     97  0.500000000E+01  0.750000000E+00  0.500000000E+00
     98  0.000000000E+00  0.100000000E+01  0.500000000E+00
     99  0.500000000E+00  0.100000000E+01  0.500000000E+00
    100  0.100000000E+01  0.100000000E+01  0.500000000E+00
    101  0.150000000E+01  0.100000000E+01  0.500000000E+00
    102  0.200000000E+01  0.100000000E+01  0.500000000E+00
    103  0.250000000E+01  0.100000000E+01  0.500000000E+00
    104  0.300000000E+01  0.100000000E+01  0.500000000E+00
    105  0.350000024E+01  0.100000000E+01  0.500000000E+00
    106  0.400000000E+01  0.100000000E+01  0.500000000E+00
    107  0.450000000E+01  0.100000000E+01  0.500000000E+00
    108  0.500000000E+01  0.100000000E+01  0.500000000E+00
    109  0.000000000E+00  0.000000000E+00  0.750000000E+00
    110  0.100000000E+01  0.000000000E+00  0.750000000E+00
    111  0.200000000E+01  0.000000000E+00  0.750000000E+00
    112  0.300000000E+01  0.000000000E+00  0.750000000E+00
    113  0.400000000E+01  0.000000000E+00  0.750000000E+00
    114  0.500000000E+01  0.000000000E+00  0.750000000E+00
    115  0.000000000E+00  0.500000000E+00  0.750000000E+00
    116  0.100000000E+01  0.500000000E+00  0.750000000E+00
    117  0.200000000E+01  0.500000000E+00  0.750000000E+00
    118  0.300000000E+01  0.500000000E+00  0.750000000E+00
    119  0.400000000E+01  0.500000000E+00  0.750000000E+00
    120  0.500000000E+01  0.500000000E+00  0.750000000E+00
    121  0.000000000E+00  0.100000000E+01  0.750000000E+00
    122  0.100000000E+01  0.100000000E+01  0.750000000E+00
    123  0.200000000E+01  0.100000000E+01  0.750000000E+00
    124  0.300000000E+01  0.100000000E+01  0.750000000E+00
    125  0.400000000E+01  0.100000000E+01  0.750000000E+00
    126  0.500000000E+01  0.100000000E+01  0.750000000E+00
    127  0.000000000E+00  0.000000000E+00  0.100000000E+01
    128  0.500000000E+00  0.000000000E+00  0.100000000E+01
    129  0.100000000E+01  0.000000000E+00  0.100000000E+01
    130  0.150000000E+01  0.000000000E+00  0.100000000E+01
    131  0.200000000E+01  0.000000000E+00  0.100000000E+01
    132  0.250000000E+01  0.000000000E+00  0.100000000E+01
    133  0.300000000E+01  0.000000000E+00  0.100000000E+01
    134  0.350000024E+01  0.000000000E+00  0.100000000E+01
    135  0.400000000E+01  0.000000000E+00  0.100000000E+01
    136  0.450000000E+01  0.000000000E+00  0.100000000E+01
    137  0.500000000E+01  0.000000000E+00  0.100000000E+01
    138  0.000000000E+00  0.250000000E+00  0.100000000E+01
    139  0.100000000E+01  0.250000000E+00  0.100000000E+01
    140  0.200000000E+01  0.250000000E+00  0.100000000E+01
    141  0.300000000E+01  0.250000000E+00  0.100000000E+01
    142  0.400000000E+01  0.250000000E+00  0.100000000E+01
    143  0.500000000E+01  0.250000000E+00  0.100000000E+01
    144  0.000000000E+00  0.500000000E+00  0.100000000E+01
    145  0.500000000E+00  0.500000000E+00  0.100000000E+01
    146  0.100000000E+01  0.500000000E+00  0.100000000E+01
    147  0.150000000E+01  0.500000000E+00  0.100000000E+01
    148  0.200000000E+01  0.500000000E+00  0.100000000E+01
    149  0.250000000E+01  0.500000000E+00  0.100000000E+01
    150  0.300000000E+01  0.500000000E+00  0.100000000E+01
    151  0.350000024E+01  0.500000000E+00  0.100000000E+01
    152  0.400000000E+01  0.500000000E+00  0.100000000E+01
    153  0.450000000E+01  0.500000000E+00  0.100000000E+01
    154  0.500000000E+01  0.500000000E+00  0.100000000E+01
    155  0.000000000E+00  0.750000000E+00  0.100000000E+01
    156  0.100000000E+01  0.750000000E+00  0.100000000E+01
    157  0.200000000E+01  0.750000000E+00  0.100000000E+01
    158  0.300000000E+01  0.750000000E+00  0.100000000E+01
    159  0.400000000E+01  0.750000000E+00  0.100000000E+01
    160  0.500000000E+01  0.750000000E+00  0.100000000E+01
    161  0.000000000E+00  0.100000000E+01  0.100000000E+01
    162  0.500000000E+00  0.100000000E+01  0.100000000E+01
    163  0.100000000E+01  0.100000000E+01  0.100000000E+01
    164  0.150000000E+01  0.100000000E+01  0.100000000E+01
    165  0.200000000E+01  0.100000000E+01  0.100000000E+01
    166  0.250000000E+01  0.100000000E+01  0.100000000E+01
    167  0.300000000E+01  0.100000000E+01  0.100000000E+01
    168  0.350000024E+01  0.100000000E+01  0.100000000E+01
    169  0.400000000E+01  0.100000000E+01  0.100000000E+01
    170  0.450000000E+01  0.100000000E+01  0.100000000E+01
    171  0.500000000E+01  0.100000000E+01  0.100000000E+01
*echo on
c 
c
incidences 
*echo off
       1       1       3      20      18      64      66      83      81,
       2      13      19      12      65      76      82      75      46,
      47      53      52
       2       3       5      22      20      66      68      85      83,
       4      14      21      13      67      77      84      76      47,
      48      54      53
       3       5       7      24      22      68      70      87      85,
       6      15      23      14      69      78      86      77      48,
      49      55      54
       4       7       9      26      24      70      72      89      87,
       8      16      25      15      71      79      88      78      49,
      50      56      55
       5       9      11      28      26      72      74      91      89,
      10      17      27      16      73      80      90      79      50,
      51      57      56
       6      18      20      37      35      81      83     100      98,
      19      30      36      29      82      93      99      92      52,
      53      59      58
       7      20      22      39      37      83      85     102     100,
      21      31      38      30      84      94     101      93      53,
      54      60      59
       8      22      24      41      39      85      87     104     102,
      23      32      40      31      86      95     103      94      54,
      55      61      60
       9      24      26      43      41      87      89     106     104,
      25      33      42      32      88      96     105      95      55,
      56      62      61
      10      26      28      45      43      89      91     108     106,
      27      34      44      33      90      97     107      96      56,
      57      63      62
      11      64      66      83      81     127     129     146     144,
      65      76      82      75     128     139     145     138     109,
     110     116     115
      12      66      68      85      83     129     131     148     146,
      67      77      84      76     130     140     147     139     110,
     111     117     116
      13      68      70      87      85     131     133     150     148,
      69      78      86      77     132     141     149     140     111,
     112     118     117
      14      70      72      89      87     133     135     152     150,
      71      79      88      78     134     142     151     141     112,
     113     119     118
      15      72      74      91      89     135     137     154     152,
      73      80      90      79     136     143     153     142     113,
     114     120     119
      16      81      83     100      98     144     146     163     161,
      82      93      99      92     145     156     162     155     115,
     116     122     121
      17      83      85     102     100     146     148     165     163,
      84      94     101      93     147     157     164     156     116,
     117     123     122
      18      85      87     104     102     148     150     167     165,
      86      95     103      94     149     158     166     157     117,
     118     124     123
      19      87      89     106     104     150     152     169     167,
      88      96     105      95     151     159     168     158     118,
     119     125     124
      20      89      91     108     106     152     154     171     169,
      90      97     107      96     153     160     170     159     119,
     120     126     125
*echo on
c 
c
blocking automatic size = 128
c 
*echo on
c
loading unit
  nodal loads
      11 force_y   0.476190E-01 force_z   0.476190E-01
      17 force_y   0.476190E-01 force_z   0.476190E-01
      28 force_y   0.476190E-01 force_z   0.476190E-01
      34 force_y   0.476190E-01 force_z   0.476190E-01
      45 force_y   0.476190E-01 force_z   0.476190E-01
      51 force_y   0.476190E-01 force_z   0.476190E-01
      57 force_y   0.476190E-01 force_z   0.476190E-01
      63 force_y   0.476190E-01 force_z   0.476190E-01
      74 force_y   0.476190E-01 force_z   0.476190E-01
      80 force_y   0.476190E-01 force_z   0.476190E-01
      91 force_y   0.476190E-01 force_z   0.476190E-01
      97 force_y   0.476190E-01 force_z   0.476190E-01
     108 force_y   0.476190E-01 force_z   0.476190E-01
     114 force_y   0.476190E-01 force_z   0.476190E-01
     120 force_y   0.476190E-01 force_z   0.476190E-01
     126 force_y   0.476190E-01 force_z   0.476190E-01
     137 force_y   0.476190E-01 force_z   0.476190E-01
     143 force_y   0.476190E-01 force_z   0.476190E-01
     154 force_y   0.476190E-01 force_z   0.476190E-01
     160 force_y   0.476190E-01 force_z   0.476190E-01
     171 force_y   0.476190E-01 force_z   0.476190E-01
c
*echo off
constraints
    plane x=0 fixed
c 
*echo on
c 
c 
 loading test
  nonlinear
    step 1-100 unit 0.01
c 
 nonlinear analysis parameters
   solution technique sparse direct 
   maximum iterations 20 $  newton iterations
   minimum iterations 1
   convergence test norm res tol 0.05
   nonconvergent solutions stop
   adaptive off
   linear stiffness for iteration one off
   batch messages off
   cpu time limit off
   material messages off
   bbar stabilization factor 0.0
   consistent q-matrix on
   time step 1.0e06
   trace solution on
   extrapolate off
   display tied mesh mpcs off
c 
c 
 list 'end' x=5.0
 compute displacements for loading test step 100
 output displacements 'end'
 output wide stresses 1 5
 output wide strains 1 5
c 
stop
